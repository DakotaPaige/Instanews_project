const url = 'https://api.nytimes.com/svc/topstories/v2/';
const apiKey = '9ef02a0589784f0db09a4dd1cbaea8ab';

$('#sectionDropdown').on('change', function(event){
  let searchSelection = $(this).val().toLowerCase();
  $('#searchResults').empty();
  // console.log(searchSelection);


  searchURL = url + searchSelection + '.json' 
  searchURL += '?' + $.param({
    'api-key': apiKey
  });
  // console.log(searchURL);
  $.ajax({
    url: searchURL,
    method: 'GET',
  })
  .done( function( data ){
    $('header').css('height','270px');
    $('header').css('margin-bottom','1rem');
    $('.nyt-logo').css('height', '150px');
    // console.log(results);
    // console.log(results[0].multimedia[2].url);

    var results = data.results;

    $.each(results, function( key, value ){
      
      console.log(results);
      // console.log(value.multimedia[2].url);
      
      let articleImage = value.multimedia[2].url;
      console.log(value.multimedia[4].url);
      
      let articleURL = value.url;
      console.log(value.url);

      let articleTitle = value.abstract;
      console.log(value.title);


      let searchResult = '';
      searchResult = '<div class="searchResult" style="background: url(\''+ articleImage + '\')';
      searchResult += ' center top / auto 100% no-repeat; ">';
      searchResult += '<a href="' + articleURL + '">';
      searchResult += '<p>' + articleTitle + '</p>';
      searchResult += '</div>';
      console.log(searchResult);

      $('#searchResults').append(searchResult);
    })
  })
  .fail(function(err) {
    console.log('fail');
  })
});
